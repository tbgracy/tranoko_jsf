<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>tranoko</title>

	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
	<h:outputStylesheet name="css/bootstrap.min.css"/>
	<h:outputStylesheet name="css/all.css"/>
	<link rel="shortcut icon" type="image/x-icon" href="resources/images/favicon.png"/> 
    </h:head>
    <h:body>
	<header>
	    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
		<a href="index.xhtml" class="navbar-brand"><h:graphicImage name="images/logo.png" class="img-fluid" width="80"/></a>

		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
		    <span class="navbar-toggler-icon"></span>
		</button>

		<div class="collapse navbar-collapse" id="navbarSupportedContent">
		    <ul class="navbar-nav ml-auto">
			<li class="nav-item">
			    <a class="nav-link" data-toggle="collapse" href="#collapseFilter" role="button" aria-controls="collapseFilter" aria-expanded="false"><i class="fas fa-search"></i> Filter</a>
			</li>
			<li class="nav-item">
			    <a href="#collapseAdd" data-toggle="collapse" role="button" aria-controls="collapsFilter" class="nav-link" aria-expanded="false"><i class="fas fa-add"></i> Add</a>
			</li>
			<li class="nav-item">
			    <a href="dashboard.xhtml" class="nav-link"><i class="fas fa-dashboard"></i> Dashboard</a>
			</li>
			<li class="nav-item">
			    <a href="settings.xhtml" class="nav-link"><i class="fas fa-gear"></i> Settings</a>
			</li>
			<li class="nav-item">
			    <h:form class="form-inline"><h:commandLink action="#{login.logout}" class="nav-link"><i class="fas fa-arrow-right-from-bracket"></i> Logout</h:commandLink>
				<img src="/tranoko/ImageServlet?proprioID=#{user.currentUserID}&amp;table=user" alt="#{user.currentUserID}" style="height:40px; width:40px; border-radius: 50%; border: solid yellow 2px; margin-left: .5em"/>
			    </h:form>
			</li>
		    </ul>
		</div>
	    </nav>
	</header>

	<div class="container mt-3 mb-3">
	    <div class="collapse" id="collapseAdd">
		<div class="jumbotron">
		    <h:form enctype="multipart/form-data">
			<div class="form-group">
			    Ville <h:inputText class="form-control" value="#{house.ville}"/>
			</div>
			<div class="form-group">
			    Adresse <h:inputText class="form-control" value="#{house.adresse}"/>
			</div>
			<div class="form-group">
			    Prix <h:inputText class="form-control" value="#{house.prix}"/>
			</div>
			<div class="form-group">
			    Categorie <h:inputText class="form-control" value="#{house.categorie}"/>
			</div>
			<div class="form-group">
			    Descriptif <h:inputTextarea class="form-control" value="#{house.descriptif}"/>
			</div>
			<div class="custom-file mb-3">
			    <h:inputFile value="#{house.uploadedPhoto}" class="custom-file-input" id="customFile"/>
			    <label class="custom-file-label" for="customFile">Choose a picture</label>
			</div>
			<h:commandButton value="Add" action="#{house.addHouse()}" class="btn btn-primary"/>
		    </h:form>
		</div>
	    </div>

	    <div class="collapse" id="collapseFilter">
		<div class="jumbotron">
		    <h:form>
			<div class="form-group">
			    Ville
			    <h:selectOneMenu class="custom-select" value="#{house.ville}">
				<f:selectItems value="#{house.villes}"/>
			    </h:selectOneMenu>
			</div>
			<div class="form-group">
			    <div class="container">
				<div class="row">
				    <div class="col">
					Prix min<h:inputText class="form-control" value="#{house.prixMin}"/>
				    </div>
				    <div class="col">
					Prix max<h:inputText class="form-control" value="#{house.prixMax}"/>
				    </div>
				</div>
			    </div>
			</div>
			<div class="form-group">
			    Categorie<h:selectOneMenu class="custom-select" value="#{house.categorie}">
				<f:selectItems value="#{house.categories}"/>
			    </h:selectOneMenu>
			</div>
			<div class="form-group mx-auto">			    
			    <h:selectOneRadio value="#{house.disponibilite}">
				<f:selectItem class="form-check-input col" itemValue="show" itemLabel="Show sold houses"/>
				<f:selectItem class="form-check-input col" itemValue="hide" itemLabel="Hide sold houses"/>
			    </h:selectOneRadio>
			</div>
			<h:commandButton value="Filter" action="#{house.filterHouse()}" class="btn btn-primary"/>
		    </h:form>
		</div>
	    </div>

	    <div class="row no-gutters">
		<!--<div class= "card-deck row">-->
		<c:forEach items="#{house.allHouses}" var="house1">
		    <div class="card col-lg-3 col-md-4">
			<img class="card-img-top" src="/tranoko/ImageServlet?proprioID=#{house1.get(0)}&amp;table=house" alt="#{house1.get(8)}" style="max-height: 10em"/>
			<div class="card-body">
			    <h5 class="card-title">#{house1.get(2)}, #{house1.get(1)} (#{house1.get(5)})</h5>
			    <h6 class="card-subtitle text-muted">#{house1.get(3)} Ar</h6>
			    <p>#{house1.get(6)}</p>
			    <h:form class="form-inline">
				<c:if test="#{house1.get(4) == 1}">
				    <h:commandButton class="btn btn-warning" action="#{purchase.buy(house1.get(0))}" value="Buy"/>
				</c:if>
				<c:if test="#{house1.get(4) == 0}">
				    <h:commandButton disabled="disabled" class="btn btn-warning disabled" value="Buy (Already Sold)"/>
				</c:if>
				<c:if test="#{house1.get(7) == user.currentUserID}">
				    <button class="btn btn-primary m-2">Edit</button>
				</c:if>
			    </h:form>

			</div>
		    </div>
		</c:forEach>
		<!--</div>-->
	    </div>

	</div>

	<footer class="bg-dark text-center text-white-50">
	    &copy; Tsierenana BÃ´tramanagna Gracy
	</footer>
	<h:outputScript name="js/jquery-3.5.1.min.js"/>
	<h:outputScript name="js/bootstrap.bundle.min.js"/>
    </h:body>
</html>

